<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Malala Reading Practice</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      line-height: 1.6;
    }
    .container {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 20px;
      max-width: 1000px;
    }
    .sentence-block {
      display: flex;
      flex-direction: row;
      width: 100%;
      margin-bottom: 10px;
    }
    .english, .chinese {
      width: 50%;
    }
    .english {
      cursor: pointer;
      padding-right: 10px;
      border-right: 1px solid #ccc;
    }
    .english:hover {
      background-color: #f9f9f9;
    }
    .word {
      margin-right: 4px; 
    }
    .word.highlight {
      color: red;
    }
  </style>
</head>
<body>
<h1>練習朗讀：Malala Yousafzai 的故事</h1>
<p>點擊左側英文句子，即可聆聽並看到逐字高亮。</p>

<div class="container">

  <!-- ====== 範例句子結構說明 ======
       1. data-fulltext：儲存該句英文的完整字串，供 TTS 使用
       2. 每個單字都用 <span class="word"> 包起來
       3. onclick：點擊時呼叫 speakSentence(...)，將句子 ID 傳入
  ================================== -->

  <!-- ★第一行：標題 (可以視需要是否加進朗讀功能) -->
  <div class="sentence-block">
    <div class="english"
         id="s0"
         data-fulltext="A Hero for Education"
         onclick="speakSentence('s0')">
      <!-- 每個單字獨立包裹 -->
      <span class="word">A</span>
      <span class="word">Hero</span>
      <span class="word">for</span>
      <span class="word">Education</span>
    </div>
    <div class="chinese">
      <p>教育的英雄</p>
    </div>
  </div>

  <!-- ★第1句 -->
  <div class="sentence-block">
    <div class="english"
         id="s1"
         data-fulltext="Malala Yousafzai is a young woman from Pakistan who is known as a hero for her work in education."
         onclick="speakSentence('s1')">
      <span class="word">Malala</span>
      <span class="word">Yousafzai</span>
      <span class="word">is</span>
      <span class="word">a</span>
      <span class="word">young</span>
      <span class="word">woman</span>
      <span class="word">from</span>
      <span class="word">Pakistan</span>
      <span class="word">who</span>
      <span class="word">is</span>
      <span class="word">known</span>
      <span class="word">as</span>
      <span class="word">a</span>
      <span class="word">hero</span>
      <span class="word">for</span>
      <span class="word">her</span>
      <span class="word">work</span>
      <span class="word">in</span>
      <span class="word">education.</span>
    </div>
    <div class="chinese">
      <p>馬拉拉·尤薩夫扎伊是一位來自巴基斯坦的年輕女性，因她在教育領域的努力而被譽為英雄。</p>
    </div>
  </div>

  <!-- ★第2句 -->
  <div class="sentence-block">
    <div class="english"
         id="s2"
         data-fulltext="She believes strongly in the power of learning and wants every child, especially girls, to go to school."
         onclick="speakSentence('s2')">
      <span class="word">She</span>
      <span class="word">believes</span>
      <span class="word">strongly</span>
      <span class="word">in</span>
      <span class="word">the</span>
      <span class="word">power</span>
      <span class="word">of</span>
      <span class="word">learning</span>
      <span class="word">and</span>
      <span class="word">wants</span>
      <span class="word">every</span>
      <span class="word">child,</span>
      <span class="word">especially</span>
      <span class="word">girls,</span>
      <span class="word">to</span>
      <span class="word">go</span>
      <span class="word">to</span>
      <span class="word">school.</span>
    </div>
    <div class="chinese">
      <p>她深信學習的力量，並希望每個孩子，尤其是女孩，都能上學。</p>
    </div>
  </div>

  <!-- ★第3句 -->
  <div class="sentence-block">
    <div class="english"
         id="s3"
         data-fulltext="When she was a child, some people in her town said that girls should not go to school."
         onclick="speakSentence('s3')">
      <span class="word">When</span>
      <span class="word">she</span>
      <span class="word">was</span>
      <span class="word">a</span>
      <span class="word">child,</span>
      <span class="word">some</span>
      <span class="word">people</span>
      <span class="word">in</span>
      <span class="word">her</span>
      <span class="word">town</span>
      <span class="word">said</span>
      <span class="word">that</span>
      <span class="word">girls</span>
      <span class="word">should</span>
      <span class="word">not</span>
      <span class="word">go</span>
      <span class="word">to</span>
      <span class="word">school.</span>
    </div>
    <div class="chinese">
      <p>當她還是孩子的時候，她所在城鎮的一些人認為女孩不應該上學。</p>
    </div>
  </div>

  <!-- ★第4句 -->
  <div class="sentence-block">
    <div class="english"
         id="s4"
         data-fulltext="But Malala and her family did not agree."
         onclick="speakSentence('s4')">
      <span class="word">But</span>
      <span class="word">Malala</span>
      <span class="word">and</span>
      <span class="word">her</span>
      <span class="word">family</span>
      <span class="word">did</span>
      <span class="word">not</span>
      <span class="word">agree.</span>
    </div>
    <div class="chinese">
      <p>但馬拉拉和她的家人並不認同。</p>
    </div>
  </div>

  <!-- ★第5句 -->
  <div class="sentence-block">
    <div class="english"
         id="s5"
         data-fulltext="She spoke up for education and wanted to make a difference in her community."
         onclick="speakSentence('s5')">
      <span class="word">She</span>
      <span class="word">spoke</span>
      <span class="word">up</span>
      <span class="word">for</span>
      <span class="word">education</span>
      <span class="word">and</span>
      <span class="word">wanted</span>
      <span class="word">to</span>
      <span class="word">make</span>
      <span class="word">a</span>
      <span class="word">difference</span>
      <span class="word">in</span>
      <span class="word">her</span>
      <span class="word">community.</span>
    </div>
    <div class="chinese">
      <p>她為教育發聲，並希望為她的社區帶來改變。</p>
    </div>
  </div>

  <!-- ★第6句 -->
  <div class="sentence-block">
    <div class="english"
         id="s6"
         data-fulltext="When Malala was just 15 years old, she was hurt very badly by people who did not want her to speak."
         onclick="speakSentence('s6')">
      <span class="word">When</span>
      <span class="word">Malala</span>
      <span class="word">was</span>
      <span class="word">just</span>
      <span class="word">15</span>
      <span class="word">years</span>
      <span class="word">old,</span>
      <span class="word">she</span>
      <span class="word">was</span>
      <span class="word">hurt</span>
      <span class="word">very</span>
      <span class="word">badly</span>
      <span class="word">by</span>
      <span class="word">people</span>
      <span class="word">who</span>
      <span class="word">did</span>
      <span class="word">not</span>
      <span class="word">want</span>
      <span class="word">her</span>
      <span class="word">to</span>
      <span class="word">speak.</span>
    </div>
    <div class="chinese">
      <p>馬拉拉只有15歲時，就遭到不希望她發聲的人嚴重傷害。</p>
    </div>
  </div>

  <!-- ★第7句 (有兩個句子，這裡示範合併為一段) -->
  <div class="sentence-block">
    <div class="english"
         id="s7"
         data-fulltext="But she was strong. She recovered and continued her fight for Quality Education and Gender Equality."
         onclick="speakSentence('s7')">
      <span class="word">But</span>
      <span class="word">she</span>
      <span class="word">was</span>
      <span class="word">strong.</span>
      <span class="word">She</span>
      <span class="word">recovered</span>
      <span class="word">and</span>
      <span class="word">continued</span>
      <span class="word">her</span>
      <span class="word">fight</span>
      <span class="word">for</span>
      <span class="word">Quality</span>
      <span class="word">Education</span>
      <span class="word">and</span>
      <span class="word">Gender</span>
      <span class="word">Equality.</span>
    </div>
    <div class="chinese">
      <p>但她很堅強。她康復後繼續為優質教育和性別平等而奮鬥。</p>
    </div>
  </div>

  <!-- ★第8句 -->
  <div class="sentence-block">
    <div class="english"
         id="s8"
         data-fulltext="She believes that every girl should have the chance to learn and grow."
         onclick="speakSentence('s8')">
      <span class="word">She</span>
      <span class="word">believes</span>
      <span class="word">that</span>
      <span class="word">every</span>
      <span class="word">girl</span>
      <span class="word">should</span>
      <span class="word">have</span>
      <span class="word">the</span>
      <span class="word">chance</span>
      <span class="word">to</span>
      <span class="word">learn</span>
      <span class="word">and</span>
      <span class="word">grow.</span>
    </div>
    <div class="chinese">
      <p>她相信每個女孩都應該有機會學習與成長。</p>
    </div>
  </div>

  <!-- ★第9句 -->
  <div class="sentence-block">
    <div class="english"
         id="s9"
         data-fulltext="In 2014, Malala received the Nobel Peace Prize."
         onclick="speakSentence('s9')">
      <span class="word">In</span>
      <span class="word">2014,</span>
      <span class="word">Malala</span>
      <span class="word">received</span>
      <span class="word">the</span>
      <span class="word">Nobel</span>
      <span class="word">Peace</span>
      <span class="word">Prize.</span>
    </div>
    <div class="chinese">
      <p>2014年，馬拉拉獲得了諾貝爾和平獎。</p>
    </div>
  </div>

  <!-- ★第10句 -->
  <div class="sentence-block">
    <div class="english"
         id="s10"
         data-fulltext="She was only 17, the youngest person to ever win this prize."
         onclick="speakSentence('s10')">
      <span class="word">She</span>
      <span class="word">was</span>
      <span class="word">only</span>
      <span class="word">17,</span>
      <span class="word">the</span>
      <span class="word">youngest</span>
      <span class="word">person</span>
      <span class="word">to</span>
      <span class="word">ever</span>
      <span class="word">win</span>
      <span class="word">this</span>
      <span class="word">prize.</span>
    </div>
    <div class="chinese">
      <p>她當時只有17歲，是史上最年輕的得主。</p>
    </div>
  </div>

  <!-- ★第11句 -->
  <div class="sentence-block">
    <div class="english"
         id="s11"
         data-fulltext="She was honored because of her courage and her work for Quality Education for all children."
         onclick="speakSentence('s11')">
      <span class="word">She</span>
      <span class="word">was</span>
      <span class="word">honored</span>
      <span class="word">because</span>
      <span class="word">of</span>
      <span class="word">her</span>
      <span class="word">courage</span>
      <span class="word">and</span>
      <span class="word">her</span>
      <span class="word">work</span>
      <span class="word">for</span>
      <span class="word">Quality</span>
      <span class="word">Education</span>
      <span class="word">for</span>
      <span class="word">all</span>
      <span class="word">children.</span>
    </div>
    <div class="chinese">
      <p>她因為她的勇氣，以及致力於所有兒童都能享受優質教育的努力而受到表彰。</p>
    </div>
  </div>

  <!-- ★第12句 -->
  <div class="sentence-block">
    <div class="english"
         id="s12"
         data-fulltext="Malala's work is also connected to the Sustainable Development Goals by the world, and goal number four is about Quality Education."
         onclick="speakSentence('s12')">
      <span class="word">Malala's</span>
      <span class="word">work</span>
      <span class="word">is</span>
      <span class="word">also</span>
      <span class="word">connected</span>
      <span class="word">to</span>
      <span class="word">the</span>
      <span class="word">Sustainable</span>
      <span class="word">Development</span>
      <span class="word">Goals</span>
      <span class="word">by</span>
      <span class="word">the</span>
      <span class="word">world,</span>
      <span class="word">and</span>
      <span class="word">goal</span>
      <span class="word">number</span>
      <span class="word">four</span>
      <span class="word">is</span>
      <span class="word">about</span>
      <span class="word">Quality</span>
      <span class="word">Education.</span>
    </div>
    <div class="chinese">
      <p>馬拉拉的工作也與全球永續發展目標相關，其中第4項目標正是優質教育。</p>
    </div>
  </div>

  <!-- ★第13句 -->
  <div class="sentence-block">
    <div class="english"
         id="s13"
         data-fulltext="Malala is a role model for many people, and her story shows us that one person can make a big difference."
         onclick="speakSentence('s13')">
      <span class="word">Malala</span>
      <span class="word">is</span>
      <span class="word">a</span>
      <span class="word">role</span>
      <span class="word">model</span>
      <span class="word">for</span>
      <span class="word">many</span>
      <span class="word">people,</span>
      <span class="word">and</span>
      <span class="word">her</span>
      <span class="word">story</span>
      <span class="word">shows</span>
      <span class="word">us</span>
      <span class="word">that</span>
      <span class="word">one</span>
      <span class="word">person</span>
      <span class="word">can</span>
      <span class="word">make</span>
      <span class="word">a</span>
      <span class="word">big</span>
      <span class="word">difference.</span>
    </div>
    <div class="chinese">
      <p>馬拉拉是許多人的榜樣，她的故事告訴我們一個人也能帶來巨大的改變。</p>
    </div>
  </div>

  <!-- ★第14句 -->
  <div class="sentence-block">
    <div class="english"
         id="s14"
         data-fulltext="Malala continues to inspire people with her story and her efforts to bring education to all children."
         onclick="speakSentence('s14')">
      <span class="word">Malala</span>
      <span class="word">continues</span>
      <span class="word">to</span>
      <span class="word">inspire</span>
      <span class="word">people</span>
      <span class="word">with</span>
      <span class="word">her</span>
      <span class="word">story</span>
      <span class="word">and</span>
      <span class="word">her</span>
      <span class="word">efforts</span>
      <span class="word">to</span>
      <span class="word">bring</span>
      <span class="word">education</span>
      <span class="word">to</span>
      <span class="word">all</span>
      <span class="word">children.</span>
    </div>
    <div class="chinese">
      <p>馬拉拉持續以她的故事和努力激勵著人們，帶給所有孩子教育的機會。</p>
    </div>
  </div>

  <!-- ★第15句 -->
  <div class="sentence-block">
    <div class="english"
         id="s15"
         data-fulltext="She shows that with courage and determination, we can work towards a better world with Gender Equality and opportunities for everyone to learn and grow."
         onclick="speakSentence('s15')">
      <span class="word">She</span>
      <span class="word">shows</span>
      <span class="word">that</span>
      <span class="word">with</span>
      <span class="word">courage</span>
      <span class="word">and</span>
      <span class="word">determination,</span>
      <span class="word">we</span>
      <span class="word">can</span>
      <span class="word">work</span>
      <span class="word">towards</span>
      <span class="word">a</span>
      <span class="word">better</span>
      <span class="word">world</span>
      <span class="word">with</span>
      <span class="word">Gender</span>
      <span class="word">Equality</span>
      <span class="word">and</span>
      <span class="word">opportunities</span>
      <span class="word">for</span>
      <span class="word">everyone</span>
      <span class="word">to</span>
      <span class="word">learn</span>
      <span class="word">and</span>
      <span class="word">grow.</span>
    </div>
    <div class="chinese">
      <p>她顯示了只要有勇氣與決心，我們可以為了更美好的世界努力，實現性別平等並讓所有人都有機會學習與成長。</p>
    </div>
  </div>

  <!-- ★第16句 -->
  <div class="sentence-block">
    <div class="english"
         id="s16"
         data-fulltext="Malala Yousafzai is truly a hero of our time."
         onclick="speakSentence('s16')">
      <span class="word">Malala</span>
      <span class="word">Yousafzai</span>
      <span class="word">is</span>
      <span class="word">truly</span>
      <span class="word">a</span>
      <span class="word">hero</span>
      <span class="word">of</span>
      <span class="word">our</span>
      <span class="word">time.</span>
    </div>
    <div class="chinese">
      <p>馬拉拉·尤薩夫扎伊確實是我們這個時代的英雄。</p>
    </div>
  </div>

</div> <!-- end container -->

<script>
  // 用於儲存當前正在被朗讀的 utterance，方便中途停止或監控事件
  let currentUtterance = null;

  function speakSentence(sentenceId) {
    // 若有前一次朗讀，先停止
    if (currentUtterance) {
      speechSynthesis.cancel();
      currentUtterance = null;
    }

    const sentenceElem = document.getElementById(sentenceId);
    if (!sentenceElem) return;

    // 取得整句的文字（去掉多餘空白）
    const fullText = sentenceElem.getAttribute('data-fulltext').trim();

    // 取得該句裡所有單字 span
    const wordSpans = sentenceElem.querySelectorAll('.word');

    // 先將所有單字顏色復原
    wordSpans.forEach(span => {
      span.classList.remove('highlight');
    });

    // 建立 utterance
    const msg = new SpeechSynthesisUtterance(fullText);
    // 設定語言（可依需求改成 'en-GB' 等）
    msg.lang = 'en-US';
    // 可以調整速度、音調...
    msg.rate = 0.05;
    msg.pitch = 1.2;

    // 用來計算每個單字在整句中的字元範圍
    // （因為 onboundary 事件給的 charIndex 是在整句中的位置）
    let charMap = [];
    let currentIndex = 0;
    for (let i = 0; i < wordSpans.length; i++) {
      let wordText = wordSpans[i].textContent;
      // 為了保留標點，可以直接用 textContent 長度
      let start = currentIndex;
      let end = start + wordText.length;
      charMap.push({ start, end, span: wordSpans[i] });
      // +1 是因為單字之間有空白(此處假設每個 span 之後有空白或換行)
      currentIndex = end + 1;
    }

    // 當 TTS 朗讀到一個 boundary（word 或其他）時觸發
    msg.onboundary = function(event) {
      // name = "word" 時才是單字界線
      // 部分瀏覽器可能用 event.name 或 event.charIndex 來判斷
      if (event.name === 'word' || event.name === 'boundary') {
        // event.charIndex：目前朗讀到的字元在整句中的位置
        let charPos = event.charIndex;
        // 找出 charPos 對應到哪個字
        for (let i = 0; i < charMap.length; i++) {
          let range = charMap[i];
          if (charPos >= range.start && charPos < range.end) {
            // 先移除所有 highlight
            wordSpans.forEach(span => span.classList.remove('highlight'));
            // 高亮目前這個字
            range.span.classList.add('highlight');
            break;
          }
        }
      }
    };

    // 朗讀結束時，把所有單字的高亮移除
    msg.onend = function() {
      wordSpans.forEach(span => span.classList.remove('highlight'));
    };

    // 開始朗讀
    currentUtterance = msg;
    speechSynthesis.speak(msg);
  }
</script>

</body>
</html>


